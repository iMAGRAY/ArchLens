# Устранение относительных путей в Archinalysator

## Проблема

AI система, использующая MCP (Model Context Protocol) сервер, не могла корректно обрабатывать относительные пути (особенно "."), что приводило к ошибкам в работе интеграции.

## Решение

Полностью устранены все использования относительных путей в проекте и заменены на абсолютные пути.

## Изменённые файлы

### 1. Rust код

#### `src/lib.rs`
- ✅ Добавлены утилитарные функции:
  - `ensure_absolute_path()` - преобразует любой путь в абсолютный
  - `get_default_project_path()` - получает абсолютный путь по умолчанию

#### `src/types.rs`
- ✅ В `AnalysisConfig::default()` заменён fallback с "." на `get_default_project_path()`

#### `src/cli/parser.rs`
- ✅ Во всех функциях парсинга (`parse_analyze`, `parse_export`, `parse_structure`, `parse_diagram`)
- ✅ Заменены fallback пути с "." на `get_default_project_path()`
- ✅ Унифицирована логика обработки путей

#### `examples/basic_analysis.rs`
- ✅ Заменён fallback с "." на кроссплатформенный абсолютный путь
- ✅ Заменены относительные пути к исполняемым файлам на абсолютные
- ✅ Добавлена функция `get_archlens_binary_path()` для получения абсолютного пути к binary

### 2. MCP конфигурация

#### `mcp/README.md`
- ✅ Обновлён пример конфигурации с абсолютными путями

#### `mcp/package.json`
- ✅ Убран относительный путь "./" из bin entry

### 3. Документация

#### `CONTRIBUTING.md`
- ✅ Обновлены примеры кода с абсолютными путями

## Логика fallback

При невозможности получить текущую директорию используются безопасные абсолютные пути:
- **Windows**: `C:\`
- **Unix/Linux**: `/tmp`

## Преимущества

1. **MCP совместимость**: AI системы теперь могут корректно обрабатывать пути
2. **Стабильность**: Нет зависимости от текущей рабочей директории
3. **Кроссплатформенность**: Корректная работа на всех ОС
4. **Безопасность**: Предсказуемое поведение в edge cases

## Функции утилит

```rust
// Преобразование в абсолютный путь
let abs_path = ensure_absolute_path("./src");

// Получение абсолютного пути по умолчанию
let default_path = get_default_project_path();
```

## Тестирование

- ✅ Проект компилируется без ошибок (`cargo check`)
- ✅ Все изменения совместимы с существующим API
- ✅ Не затронута функциональность

## Обратная совместимость

Все изменения полностью обратно совместимы. API не изменился, изменилась только внутренняя логика обработки путей.

---
**Статус**: ✅ Завершено
**Дата**: $(date)
**Версия**: После устранения относительных путей 